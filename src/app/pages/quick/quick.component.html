<div class="container" id="addTrip">
    <div><app-current-average class="field-right"></app-current-average></div>
    
    <quick-form (parentReload)="load()"></quick-form>

    <h2 *ngIf="unsavedTrips.length > 0" id="unsavedTrips">Unsaved Local Trips</h2>
    <div *ngFor="let trip of unsavedTrips" [ngClass]="{'mat-card': unsavedTrips.length % 2 != 0, 'mat-card-reverse': unsavedTrips.length % 2 == 0, 'mat-card-disabled': trip.exclude == true }">
        <trips-quick-view [trip]="trip"></trips-quick-view>
        <div mat-card class="row-flex button-bar">
                <button mat-fab extended color="primary" class="button-left" (click)="editUnsavedLocalTrip(trip)"><mat-icon>edit</mat-icon> Edit</button>
                <button mat-fab extended color="accent" (click)="setPickupTime(trip)" *ngIf="!trip.pickupTime && !trip.dropoffTime && !trip.exclude"><mat-icon>update</mat-icon> Pickup</button>
                <button mat-fab extended color="accent" (click)="setDropoffTime(trip)" *ngIf="trip.pickupTime && !trip.dropoffTime && !trip.exclude"><mat-icon>schedule</mat-icon> Dropoff</button>
                <button mat-fab color="primary" [matMenuTriggerFor]="menu" aria-label="Trip menu">
                    <mat-icon>more_vert</mat-icon>
                </button>
                <mat-menu color="primary" #menu="matMenu">
                    <!-- <button mat-menu-item>
                        <mat-icon>block</mat-icon>
                        <span>Exclude</span>
                    </button> -->
                    <button mat-menu-item (click)="nextUnsavedLocalTrip(trip)">
                        <mat-icon>pin_drop</mat-icon>
                        <span>Next</span>
                    </button>
                    <button mat-menu-item (click)="cloneUnsavedLocalTrip(trip)">
                        <mat-icon>content_copy</mat-icon>
                        <span>Clone</span>
                        </button>
                    <button mat-menu-item [attr.color]="'warn'" (click)="confirmDeleteTripDialog(trip)">
                        <mat-icon color="warn">delete</mat-icon>
                        <span>Delete</span>
                    </button>
                </mat-menu>
        </div>
    </div>
    <div class="row-grid">
        <button mat-fab extended class="button" color="accent" [class.spinner]="saving" [disabled]="saving || defaultSheet?.id === demoSheetId" (click)="confirmSaveTripsDialog()" *ngIf="unsavedTrips.length > 0"><mat-icon>save</mat-icon> Save Trips to Spreadsheet</button>
    </div>

    <div class="row-grid" *ngIf="savedTrips.length > 0" id="savedLocalTrips">
        <trips-table-simple class="table" title="Saved Local Trips" [trips]="savedTrips"></trips-table-simple>
        <div class="row-block">
            <button mat-fab extended [class.spinner]="clearing" [disabled]="clearing" (click)="confirmUnsaveTripsDialog()"><mat-icon>undo</mat-icon> Unsave Trips</button>
            <button mat-fab extended class="button-right" color="warn" [class.spinner]="clearing" [disabled]="clearing"  (click)="confirmClearTripsDialog()"><mat-icon>delete</mat-icon> Clear</button>
        </div>
    </div>

    <div class="row-grid">
        <app-trips-table-group class="table" title="{{defaultSheet?.name}} - Trips" link="{{defaultSheet?.id}}" [days]=6></app-trips-table-group>
        <button mat-fab extended color="primary" class="button" [class.spinner]="reloading" [disabled]="reloading"  (click)="reload()"><mat-icon>refresh</mat-icon> Reload</button>
    </div>

</div>