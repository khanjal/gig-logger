<div class="container mx-auto p-4 max-w-4xl">
  <div class="flex flex-wrap gap-4 mb-6 items-center justify-between">
    <h1 class="text-2xl font-bold text-blue-700 flex-1">Metrics</h1>
    <mat-form-field appearance="outline" class="w-[265px] md:ml-auto">
      <mat-label>Select a date range</mat-label>
      <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
        <input matStartDate formControlName="start" placeholder="Start date" (dateChange)="filterByDate()" />
        <input matEndDate formControlName="end" placeholder="End date" (dateChange)="filterByDate()" />
      </mat-date-range-input>
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-date-range-picker 
        #picker
        [calendarHeaderComponent]="CustomCalendarHeaderComponent"></mat-date-range-picker>
    </mat-form-field>
  </div>

  <div class="bg-white rounded-lg shadow p-4 md:col-span-2">
      <h2 class="text-lg font-semibold mb-2">Total Pay</h2>
      <canvas baseChart
      [data]="payData"
      [options]="barOptions"
      [type]="'bar'"
      class="w-full h-[500px] max-h-[500px]"></canvas>
  </div>
  <div *ngIf="dailyEarningsData.datasets.length > 1" class="bg-white rounded-lg shadow p-4 md:col-span-2">
    <h2 class="text-lg font-semibold mb-2">Daily Earnings by Service</h2>
    <canvas baseChart
      [data]="dailyEarningsData"
      [options]="barOptions"
      [type]="'bar'"
      class="w-full h-[500px] max-h-[500px]"></canvas>
  </div>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <div class="bg-white rounded-lg shadow p-4">
      <h2 class="text-lg font-semibold mb-2">Total Trips</h2>
      <canvas baseChart
          [data]="tripsData"
          [options]="barOptions"
          [type]="'bar'"
          class="w-full h-[500px] max-h-[500px]"></canvas>
      </div>
      <div class="bg-white rounded-lg shadow p-4">
      <h2 class="text-lg font-semibold mb-2">Total Distance</h2>
      <canvas baseChart
          [data]="distanceData"
          [options]="lineOptions"
          [type]="'line'"
          class="w-full h-[500px] max-h-[500px]"></canvas>
      </div>
      <div *ngIf="servicePieData && servicePieData.labels && servicePieData.labels.length > 1" class="bg-white rounded-lg shadow p-4 md:col-span-2 max-w-md mx-auto">
      <h2 class="text-lg font-semibold mb-2">Service Count Distribution</h2>
      <canvas baseChart
          [data]="servicePieData"
          [options]="pieOptions"
          [type]="'pie'"
          class="w-full h-64"></canvas>
      </div>
  </div>
</div>
