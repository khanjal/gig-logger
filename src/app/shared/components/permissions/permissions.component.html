<app-base-card 
  title="App Permissions"
  [titleIcon]="'settings'"
  variant="default"
  padding="md">
  <p class="text-gray-600 dark:text-gray-200 mb-4">
    Manage permissions for place search and voice input features.
  </p>

    <div class="grid grid-cols-1 gap-3">
      <!-- Location Permission -->
      <div class="permission-item">
        <div class="permission-header">
          <mat-icon [class]="'permission-icon ' + getStateColor(locationPermission.state)">
            {{ locationPermission.icon }}
          </mat-icon>
          <div class="permission-info">
            <h3 class="permission-name">{{ locationPermission.name }}</h3>
            <p class="permission-description">{{ locationPermission.description }}</p>
          </div>
        </div>
        
        <div class="permission-status">
          <div class="status-badge" [class]="getStateColor(locationPermission.state)">
            <mat-icon class="status-icon">{{ getStateIcon(locationPermission.state) }}</mat-icon>
            <span>{{ getStateText(locationPermission.state) }}</span>
          </div>
          
          <div class="permission-actions flex justify-end">
            @if (locationPermission.canRequest) {
            <app-base-rect-button 
              variant="primary"
              [icon]="'check'"
              (clicked)="requestLocation()">
              Enable
            </app-base-rect-button>
            }
          </div>
        </div>

        @if (locationPermission.state === 'denied') {
          <div class="permission-help">
            <mat-icon class="help-icon">info</mat-icon>
            <p>Location access is blocked. Click "Browser Settings" to change this in your browser.</p>
          </div>
        }
        @if (locationPermission.state === 'unsupported') {
          <div class="permission-help warning">
            <mat-icon class="help-icon">warning</mat-icon>
            <p>Your browser does not support location services.</p>
          </div>
        }
      </div>

      <!-- Microphone Permission -->
      <div class="permission-item">
        <div class="permission-header">
          <mat-icon [class]="'permission-icon ' + getStateColor(microphonePermission.state)">
            {{ microphonePermission.icon }}
          </mat-icon>
          <div class="permission-info">
            <h3 class="permission-name">{{ microphonePermission.name }}</h3>
            <p class="permission-description">{{ microphonePermission.description }}</p>
          </div>
        </div>
        
        <div class="permission-status">
          <div class="status-badge" [class]="getStateColor(microphonePermission.state)">
            <mat-icon class="status-icon">{{ getStateIcon(microphonePermission.state) }}</mat-icon>
            <span>{{ getStateText(microphonePermission.state) }}</span>
          </div>
          
          <div class="permission-actions flex justify-end">
            @if (microphonePermission.canRequest) {
              <app-base-rect-button 
                variant="primary"
                [icon]="'check'"
                (clicked)="requestMicrophone()">
                Enable
              </app-base-rect-button>
            }
          </div>
        </div>

        @if (microphonePermission.state === 'denied') {
          <div class="permission-help">
            <mat-icon class="help-icon">info</mat-icon>
            <p>Microphone access is blocked. Click "Browser Settings" to change this in your browser.</p>
          </div>
        }
        @if (microphonePermission.state === 'unsupported') {
          <div class="permission-help warning">
            <mat-icon class="help-icon">warning</mat-icon>
            <p>Your browser does not support microphone access.</p>
          </div>
        }
      </div>
    </div>

    <!-- General Info -->
    @if (
      locationPermission.state === 'denied' || locationPermission.state === 'granted' ||
      microphonePermission.state === 'denied' || microphonePermission.state === 'granted'
    ) {
      <div class="permissions-footer flex justify-end">
      <app-base-rect-button 
        variant="primary"
        [icon]="'settings'"
        (clicked)="openBrowserSettings()">
        Browser Settings
      </app-base-rect-button>
      </div>
    }
    <div class="permissions-footer">
      <mat-icon class="footer-icon">lock</mat-icon>
          <p class="text-sm text-gray-500 dark:text-gray-200">
        Your privacy matters. These permissions are only used for the features described and never shared.
      </p>
    </div>
  </app-base-card>
