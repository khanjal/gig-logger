<div class="diagnostics-container">
  <div class="diagnostics-actions">
    <button mat-raised-button color="primary" (click)="runDiagnostics()" [disabled]="isLoading">
      <mat-icon>refresh</mat-icon>
      {{ isLoading ? 'Running...' : 'Run Diagnostics' }}
    </button>
  </div>

  <mat-card>
    <mat-card-header>
      <mat-card-title>
        <mat-icon>table_chart</mat-icon>
        Spreadsheet
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-list>
        <mat-list-item *ngFor="let item of sheetDiagnostics">
          <mat-icon [color]="getSeverityColor(item.severity)" matListItemIcon>
            {{ getSeverityIcon(item.severity) }}
          </mat-icon>
          <div matListItemTitle>{{ item.name }}</div>
          <div matListItemLine>{{ item.description }}</div>
          <div matListItemMeta>{{ item.count }}</div>
        </mat-list-item>
      </mat-list>
    </mat-card-content>
  </mat-card>

  <mat-card>
    <mat-card-header>
      <mat-card-title>
        <mat-icon>data_usage</mat-icon>
        Data
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-list>
        <mat-list-item *ngFor="let item of dataDiagnostics">
          <mat-icon [color]="getSeverityColor(item.severity)" matListItemIcon>
            {{ getSeverityIcon(item.severity) }}
          </mat-icon>
          <div matListItemTitle>{{ item.name }}</div>
          <div matListItemLine>{{ item.description }}</div>
          <div matListItemMeta>{{ item.count }}</div>
        </mat-list-item>
      </mat-list>
    </mat-card-content>
  </mat-card>
</div>